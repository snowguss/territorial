<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Territorial - Gestão de Territórios</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <header class="app-header">
    <button id="home-btn" class="header-btn" onclick="mostrarTela('home')">&#127968;</button>
    <h1><strong>Territorial</strong></h1>
    <button id="hamburger-btn" class="header-btn" onclick="toggleHamburgerMenu()">&#9776;</button>
  </header>

  <div id="hamburger-menu" class="menu hidden">
    <button onclick="mostrarTela('criar'); toggleHamburgerMenu();">Criar Território</button>
    <button onclick="mostrarTela('endereco'); toggleHamburgerMenu();">Adicionar Endereço</button>
    <button onclick="mostrarTela('config'); toggleHamburgerMenu();">Configurações</button>
    <button onclick="reorganizarTerritorios(); toggleHamburgerMenu();">Reorganizar Tudo</button>
  </div>

  <div class="main-wrapper">
    <div class="container home">
      <div class="form-container">
        <!-- Tela Criar Território -->
        <div id="telaCriar" class="hidden">
          <h2>Criar Território</h2>
          <div class="form-group">
            <label for="bairro">Bairro:</label>
            <div class="input-with-toggle">
              <input type="text" id="bairro-input">
              <button class="toggle-btn" onclick="toggleBairrosList(event)" data-target="bairros-select-list">▼</button>
            </div>
            <ul id="bairros-select-list" class="bairros-lista"></ul>
          </div>
          <div class="form-group">
            <label for="nomeTerritorio">Nome do Território:</label>
            <input type="text" id="nomeTerritorio">
          </div>
          <button onclick="criarTerritorio()">Salvar Território</button>
        </div>

        <!-- Tela Adicionar Endereço -->
        <div id="telaEndereco" class="hidden">
          <h2>Adicionar Endereço</h2>
          <div class="form-group">
            <label for="territorioManual">Adicionar ao Território (Opcional):</label>
            <select id="territorioManual"
              style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--outline-color);">
              <option value="">Automático</option>
            </select>
          </div>
          <div class="form-group">
            <label for="ruaInput">Rua:</label>
            <input type="text" id="rua-input" list="ruas-autocomplete">
            <datalist id="ruas-autocomplete"></datalist>
          </div>
          <div class="form-group">
            <label for="numeroInput">Número:</label>
            <input type="text" id="numeroInput">
          </div>
          <div class="form-group">
            <label for="bairroEndereco">Bairro:</label>
            <input type="text" id="bairro-endereco" list="bairros-autocomplete">
            <datalist id="bairros-autocomplete"></datalist>
          </div>
          <div class="form-group">
            <label for="cepInput">CEP:</label>
            <div class="input-with-toggle">
              <input type="text" id="cepInput" maxlength="9" placeholder="00000-000">
              <div id="cepSuggestions" class="suggestions-list hidden"></div>
            </div>
          </div>
          <div class="form-group">
            <label for="observacoesInput">Observações:</label>
            <input type="text" id="observacoesInput" placeholder="Ex: Apartamento 101, Casa Verde, etc">
          </div>
          <button onclick="adicionarEndereco()">Adicionar</button>
        </div>

        <!-- Tela Configurações -->
        <div id="telaConfig" class="hidden">
          <h2>Configurações</h2>
          <!-- View mode -->
          <div id="viewProfile" class="hidden">
            <div class="profile-info">
              <p><strong>Nome:</strong> <span id="viewNome"></span></p>
              <p><strong>Congregação:</strong> <span id="viewCongregacao"></span></p>
              <p><strong>Cidade:</strong> <span id="viewCidade"></span></p>
            </div>
            <div class="stats-info"
              style="margin: 16px 0; padding: 16px; background: var(--surface-container-high); border-radius: 8px;">
              <h4 style="margin-top: 0; color: var(--primary-color);">Estatísticas</h4>
              <p><strong>Total de Territórios:</strong> <span id="totalTerritorios">0</span></p>
              <p><strong>Total de Endereços:</strong> <span id="totalEnderecos">0</span></p>
            </div>
            <button onclick="toggleProfileMode('edit')" style="margin-bottom: 24px;">Editar Perfil</button>
          </div>

          <!-- Edit mode -->
          <div id="editProfile">
            <div class="form-group">
              <label for="nomePublicador">Nome do Publicador:</label>
              <input type="text" id="nomePublicador">
            </div>
            <div class="form-group">
              <label for="congregacao">Congregação:</label>
              <input type="text" id="congregacao">
            </div>
            <div class="form-group">
              <label for="cidadePadrao">Cidade:</label>
              <input type="text" id="cidadePadrao">
            </div>
            <button onclick="salvarPerfil()">Salvar Perfil</button>
          </div>

          <h3 style="margin-top: 24px;">Gerenciamento de Dados</h3>
          <button onclick="exportarDados()">Exportar Dados</button>
          <button onclick="document.getElementById('import-file').click();">Importar Dados</button>
          <input type="file" id="import-file" class="hidden" onchange="importarDados(event)" accept=".json">
        </div>
      </div>

      <div class="list-container">
        <h2 id="sugestoes-titulo" class="hidden">Sugestão de Envio</h2>
        <div id="sugestoesTerritorios"></div>

        <h2 id="recentes-titulo" class="hidden">Enviados Recentemente</h2>
        <div id="recentesTerritorios"></div>

        <h2 id="territorios-titulo">Territórios</h2>
        <div id="listaTerritorios"></div>
      </div>
    </div>
  </div>

  <!-- Modal de Edição de Endereços -->
  <div id="modalEdicao" class="modal">
    <div class="modal-content">
      <span class="modal-close" onclick="fecharModal()">&times;</span>
      <h3 id="modal-titulo">Editar Endereços</h3>
      <ul id="modal-enderecos-lista"></ul>
      <div style="text-align: right; margin-top: 16px;">
        <button id="salvarOrdemBtn" onclick="confirmarNovaOrdem()">Salvar nova ordem</button>
      </div>
    </div>
  </div>

  <!-- Modal de Boas-Vindas -->
  <div id="welcomeModal" class="welcome-modal hidden">
    <div class="welcome-content">
      <h2>Bem-vindo ao Territorial!</h2>
      <p>Para começar, precisamos de algumas informações:</p>
      <div class="form-group">
        <label for="initialNome">Seu Nome:</label>
        <input type="text" id="initialNome" required>
      </div>
      <div class="form-group">
        <label for="initialCongregacao">Sua Congregação:</label>
        <input type="text" id="initialCongregacao" required>
      </div>
      <div class="form-group">
        <label for="initialCidade">Sua Cidade:</label>
        <input type="text" id="initialCidade" required>
      </div>
      <button onclick="salvarPerfilInicial()">Começar</button>
    </div>
  </div>

  <!-- Adicionar antes do fechamento do body -->
  <div class="toast-container"></div>
  <div class="loading-overlay">
    <div class="loading-spinner"></div>
  </div>

  <script src="config.js"></script>
  <script src="script.js"></script>
</body>

</html>